#!/usr/sunos/bin/sh
# ----------------------------------------------------------------------
# Ericsson Network IQ Interface activation script
#
# Usage: activate_interface INTERFACE_NAME OSS_NAME IN_DIR
#
# Author: Janne Berggren
#
# ----------------------------------------------------------------------
# Copyright (c) 1999 - 2006 AB LM Ericsson Oy  All rights reserved.
# ----------------------------------------------------------------------

### Function: usage_msg ###
#
#   Print out the usage message
#
# Arguments:
#	none
# Return Values:
#	none
usage_msg() 
{
echo ""
echo "Usage: `basename $0` -p <new_password>"
echo "options:"
echo "-p  : New password for alarm interfaces."
}

if [ ! -r "${CONF_DIR}/niq.rc" ] ; then
  echo "ERROR: Source file is not readable at ${CONF_DIR}/niq.rc"
  exit 1
fi

. ${CONF_DIR}/niq.rc



while getopts ":p:" Option
do
  case $Option in
    p) NEW_PASSWORD="$OPTARG" 
       ;;
   \?) usage_msg
       exit 2 
       ;;
  esac
done

if [ -z "${NEW_PASSWORD}" ]; then
    echo "New alarm password must be given to the script."
    usage_msg
    exit 3
fi

DIRS=`ls ${PLATFORM_DIR}`

for file in $DIRS
do
  if [ -d ${PLATFORM_DIR}/$file/dclib ]
  then
    JARS=`ls ${PLATFORM_DIR}/$file/dclib/*.jar`

    for jar in $JARS
    do
      CPATH="${CPATH}:${jar}"
    done
  fi
done


CURRENT_WORKING_DIRECTORY=`pwd`
JAVA_HOME=${RT_DIR}/java
export JAVA_HOME
# Change the password.
${RT_DIR}/ant/bin/ant -f alarm_utils.xml -lib ${CPATH} -Ddc.bin.dir=${BIN_DIR} -DnewAlarmPassword=${NEW_PASSWORD} change_alarm_password




